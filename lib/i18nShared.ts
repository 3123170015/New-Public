export const SUPPORTED_LANGUAGES = {
  vi: { label: "Tiếng Việt", native: "Tiếng Việt" },
  en: { label: "English", native: "English" },
  zh: { label: "中文", native: "中文" },
  id: { label: "Bahasa Indonesia", native: "Bahasa Indonesia" },
  ms: { label: "Bahasa Melayu", native: "Bahasa Melayu" },
} as const;

export type Language = keyof typeof SUPPORTED_LANGUAGES;

export const DEFAULT_LANGUAGE: Language = "vi";

export function isLanguageSupported(input?: string | null): input is Language {
  return Boolean(input && Object.prototype.hasOwnProperty.call(SUPPORTED_LANGUAGES, input));
}

const translations: Record<Language, Record<string, string>> = {
  vi: {
    "nav.home": "Trang chủ",
    "nav.feed": "Feed",
    "nav.subscriptions": "Theo dõi",
    "nav.history": "Lịch sử",
    "nav.playlists": "Playlists",
    "nav.trending": "Xu hướng",
    "nav.boost": "Boost",
    "nav.nft": "NFT",
    "nav.premium": "Premium",
    "nav.upload": "Upload",
    "nav.studio": "Studio",
    "nav.admin": "Admin",
    "nav.login": "Đăng nhập",
    "nav.register": "Đăng ký",
    "nav.theme": "Giao diện",
    "nav.themes": "Giao diện Preset",
    "footer.sitemap": "Sitemap",
    "footer.robots": "Robots",
    "footer.llms": "LLMs",
    "footer.language": "Ngôn ngữ",
    "menu.profile": "Hồ sơ",
    "menu.myChannel": "Kênh của tôi",
    "menu.notifications": "Thông báo",
    "menu.notificationSettings": "Cài đặt thông báo",
    "menu.logout": "Đăng xuất",
    "settings.language.title": "Ngôn ngữ giao diện",
    "settings.language.subtitle": "Chọn ngôn ngữ hiển thị cho tài khoản của bạn.",
    "actions.apply": "Áp dụng",
    "auth.login.title": "Đăng nhập",
    "auth.login.subtitle": "Dùng Credentials. Nếu chưa có admin, chạy npm run prisma:seed.",
    "auth.login.error": "Sai email hoặc mật khẩu",
    "auth.login.submit": "Sign in",
    "auth.login.register": "Chưa có tài khoản? Đăng ký",
    "auth.register.title": "Đăng ký",
    "auth.register.subtitle": "Tạo tài khoản mới để theo dõi video & bộ sưu tập.",
    "auth.register.errorMissing": "Vui lòng điền đầy đủ thông tin.",
    "auth.register.errorMismatch": "Mật khẩu xác nhận không khớp.",
    "auth.register.errorDisabled": "Đăng ký tạm thời bị tắt. Vui lòng liên hệ quản trị.",
    "auth.register.errorGeneric": "Không thể tạo tài khoản.",
    "auth.register.errorNetwork": "Không thể kết nối tới máy chủ.",
    "auth.register.success": "Đăng ký thành công! Bạn có thể đăng nhập ngay.",
    "auth.register.loading": "Đang tạo...",
    "auth.register.submit": "Tạo tài khoản",
    "auth.register.login": "Đã có tài khoản? Đăng nhập",
    "auth.register.disabledTitle": "Đăng ký tạm thời bị tắt",
    "auth.register.disabledSubtitle": "Vui lòng liên hệ quản trị để được hỗ trợ.",
    "auth.password": "Password",
    "auth.passwordConfirm": "Xác nhận mật khẩu",
    "auth.name": "Tên hiển thị",
    "auth.backHome": "Quay lại Home",
  },
  en: {
    "nav.home": "Home",
    "nav.feed": "Feed",
    "nav.subscriptions": "Subscriptions",
    "nav.history": "History",
    "nav.playlists": "Playlists",
    "nav.trending": "Trending",
    "nav.boost": "Boost",
    "nav.nft": "NFT",
    "nav.premium": "Premium",
    "nav.upload": "Upload",
    "nav.studio": "Studio",
    "nav.admin": "Admin",
    "nav.login": "Login",
    "nav.register": "Register",
    "nav.theme": "Theme",
    "nav.themes": "Theme Presets",
    "footer.sitemap": "Sitemap",
    "footer.robots": "Robots",
    "footer.llms": "LLMs",
    "footer.language": "Language",
    "menu.profile": "Profile",
    "menu.myChannel": "My channel",
    "menu.notifications": "Notifications",
    "menu.notificationSettings": "Notification settings",
    "menu.logout": "Logout",
    "settings.language.title": "Interface language",
    "settings.language.subtitle": "Choose the display language for your account.",
    "actions.apply": "Apply",
    "auth.login.title": "Login",
    "auth.login.subtitle": "Credentials only. Run npm run prisma:seed to create the admin.",
    "auth.login.error": "Invalid email or password",
    "auth.login.submit": "Sign in",
    "auth.login.register": "Need an account? Register",
    "auth.register.title": "Register",
    "auth.register.subtitle": "Create a new account to follow videos and collections.",
    "auth.register.errorMissing": "Please fill in all required fields.",
    "auth.register.errorMismatch": "Password confirmation does not match.",
    "auth.register.errorDisabled": "Signup is currently disabled. Please contact support.",
    "auth.register.errorGeneric": "Unable to create account.",
    "auth.register.errorNetwork": "Unable to reach the server.",
    "auth.register.success": "Registration successful. You can log in now.",
    "auth.register.loading": "Creating...",
    "auth.register.submit": "Create account",
    "auth.register.login": "Already have an account? Login",
    "auth.register.disabledTitle": "Signup is disabled",
    "auth.register.disabledSubtitle": "Please contact the administrator for access.",
    "auth.password": "Password",
    "auth.passwordConfirm": "Confirm password",
    "auth.name": "Display name",
    "auth.backHome": "Back to Home",
  },
  zh: {
    "nav.home": "首页",
    "nav.feed": "动态",
    "nav.subscriptions": "订阅",
    "nav.history": "历史记录",
    "nav.playlists": "播放列表",
    "nav.trending": "趋势",
    "nav.boost": "推广",
    "nav.nft": "NFT",
    "nav.premium": "高级",
    "nav.upload": "上传",
    "nav.studio": "工作室",
    "nav.admin": "管理",
    "nav.login": "登录",
    "nav.register": "注册",
    "nav.theme": "主题",
    "nav.themes": "主题预设",
    "footer.sitemap": "网站地图",
    "footer.robots": "Robots",
    "footer.llms": "LLMs",
    "footer.language": "语言",
    "menu.profile": "个人资料",
    "menu.myChannel": "我的频道",
    "menu.notifications": "通知",
    "menu.notificationSettings": "通知设置",
    "menu.logout": "退出",
    "settings.language.title": "界面语言",
    "settings.language.subtitle": "选择账户的显示语言。",
    "actions.apply": "应用",
    "auth.login.title": "登录",
    "auth.login.subtitle": "仅支持凭据登录。先运行 npm run prisma:seed 创建管理员。",
    "auth.login.error": "邮箱或密码无效",
    "auth.login.submit": "登录",
    "auth.login.register": "没有账户？注册",
    "auth.register.title": "注册",
    "auth.register.subtitle": "创建新账户以跟踪视频与收藏。",
    "auth.register.errorMissing": "请填写完整信息。",
    "auth.register.errorMismatch": "确认密码不一致。",
    "auth.register.errorDisabled": "注册已暂时关闭，请联系管理员。",
    "auth.register.errorGeneric": "无法创建账户。",
    "auth.register.errorNetwork": "无法连接服务器。",
    "auth.register.success": "注册成功！现在可以登录。",
    "auth.register.loading": "正在创建...",
    "auth.register.submit": "创建账户",
    "auth.register.login": "已有账户？登录",
    "auth.register.disabledTitle": "注册已关闭",
    "auth.register.disabledSubtitle": "请联系管理员获取访问权限。",
    "auth.password": "密码",
    "auth.passwordConfirm": "确认密码",
    "auth.name": "显示名称",
    "auth.backHome": "返回首页",
  },
  id: {
    "nav.home": "Beranda",
    "nav.feed": "Feed",
    "nav.subscriptions": "Langganan",
    "nav.history": "Riwayat",
    "nav.playlists": "Daftar putar",
    "nav.trending": "Tren",
    "nav.boost": "Boost",
    "nav.nft": "NFT",
    "nav.premium": "Premium",
    "nav.upload": "Unggah",
    "nav.studio": "Studio",
    "nav.admin": "Admin",
    "nav.login": "Masuk",
    "nav.register": "Daftar",
    "nav.theme": "Tema",
    "nav.themes": "Preset Tema",
    "footer.sitemap": "Peta situs",
    "footer.robots": "Robots",
    "footer.llms": "LLMs",
    "footer.language": "Bahasa",
    "menu.profile": "Profil",
    "menu.myChannel": "Channel saya",
    "menu.notifications": "Notifikasi",
    "menu.notificationSettings": "Pengaturan notifikasi",
    "menu.logout": "Keluar",
    "settings.language.title": "Bahasa antarmuka",
    "settings.language.subtitle": "Pilih bahasa tampilan untuk akun Anda.",
    "actions.apply": "Terapkan",
    "auth.login.title": "Masuk",
    "auth.login.subtitle": "Hanya kredensial. Jalankan npm run prisma:seed untuk admin.",
    "auth.login.error": "Email atau kata sandi salah",
    "auth.login.submit": "Masuk",
    "auth.login.register": "Belum punya akun? Daftar",
    "auth.register.title": "Daftar",
    "auth.register.subtitle": "Buat akun baru untuk mengikuti video & koleksi.",
    "auth.register.errorMissing": "Harap lengkapi semua kolom.",
    "auth.register.errorMismatch": "Konfirmasi kata sandi tidak cocok.",
    "auth.register.errorDisabled": "Pendaftaran sedang dinonaktifkan. Hubungi admin.",
    "auth.register.errorGeneric": "Tidak bisa membuat akun.",
    "auth.register.errorNetwork": "Tidak bisa terhubung ke server.",
    "auth.register.success": "Registrasi berhasil. Anda bisa login sekarang.",
    "auth.register.loading": "Membuat...",
    "auth.register.submit": "Buat akun",
    "auth.register.login": "Sudah punya akun? Masuk",
    "auth.register.disabledTitle": "Pendaftaran dinonaktifkan",
    "auth.register.disabledSubtitle": "Hubungi admin untuk mendapatkan akses.",
    "auth.password": "Kata sandi",
    "auth.passwordConfirm": "Konfirmasi kata sandi",
    "auth.name": "Nama tampilan",
    "auth.backHome": "Kembali ke Home",
  },
  ms: {
    "nav.home": "Laman utama",
    "nav.feed": "Feed",
    "nav.subscriptions": "Langganan",
    "nav.history": "Sejarah",
    "nav.playlists": "Senarai main",
    "nav.trending": "Trend",
    "nav.boost": "Boost",
    "nav.nft": "NFT",
    "nav.premium": "Premium",
    "nav.upload": "Muat naik",
    "nav.studio": "Studio",
    "nav.admin": "Admin",
    "nav.login": "Log masuk",
    "nav.register": "Daftar",
    "nav.theme": "Tema",
    "nav.themes": "Preset Tema",
    "footer.sitemap": "Peta laman",
    "footer.robots": "Robots",
    "footer.llms": "LLMs",
    "footer.language": "Bahasa",
    "menu.profile": "Profil",
    "menu.myChannel": "Saluran saya",
    "menu.notifications": "Notifikasi",
    "menu.notificationSettings": "Tetapan notifikasi",
    "menu.logout": "Log keluar",
    "settings.language.title": "Bahasa antara muka",
    "settings.language.subtitle": "Pilih bahasa paparan untuk akaun anda.",
    "actions.apply": "Gunakan",
    "auth.login.title": "Log masuk",
    "auth.login.subtitle": "Hanya kredensial. Jalankan npm run prisma:seed untuk admin.",
    "auth.login.error": "E-mel atau kata laluan tidak sah",
    "auth.login.submit": "Log masuk",
    "auth.login.register": "Belum ada akaun? Daftar",
    "auth.register.title": "Daftar",
    "auth.register.subtitle": "Cipta akaun baharu untuk mengikuti video & koleksi.",
    "auth.register.errorMissing": "Sila isi semua maklumat.",
    "auth.register.errorMismatch": "Pengesahan kata laluan tidak sepadan.",
    "auth.register.errorDisabled": "Pendaftaran ditutup buat sementara. Hubungi admin.",
    "auth.register.errorGeneric": "Tidak dapat mencipta akaun.",
    "auth.register.errorNetwork": "Tidak dapat sambung ke pelayan.",
    "auth.register.success": "Pendaftaran berjaya. Anda boleh log masuk.",
    "auth.register.loading": "Sedang mencipta...",
    "auth.register.submit": "Cipta akaun",
    "auth.register.login": "Sudah ada akaun? Log masuk",
    "auth.register.disabledTitle": "Pendaftaran ditutup",
    "auth.register.disabledSubtitle": "Hubungi pentadbir untuk akses.",
    "auth.password": "Kata laluan",
    "auth.passwordConfirm": "Sahkan kata laluan",
    "auth.name": "Nama paparan",
    "auth.backHome": "Kembali ke Home",
  },
};

export function normalizeLanguage(input?: string | null): Language {
  const raw = String(input || "").trim().toLowerCase();
  if (!raw) return DEFAULT_LANGUAGE;
  if (raw.startsWith("vi")) return "vi";
  if (raw.startsWith("en")) return "en";
  if (raw.startsWith("zh")) return "zh";
  if (raw.startsWith("id") || raw.startsWith("in")) return "id";
  if (raw.startsWith("ms")) return "ms";
  return DEFAULT_LANGUAGE;
}

export function t(lang: Language, key: string) {
  const bucket = translations[lang] ?? translations[DEFAULT_LANGUAGE];
  return bucket[key] ?? translations[DEFAULT_LANGUAGE][key] ?? key;
}
